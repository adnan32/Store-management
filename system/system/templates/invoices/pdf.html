<!DOCTYPE html>
{% load i18n %}
<html lang="en">
<head>
  <style>
    @page { margin: 2cm; }
    body { font-family: "DejaVu Sans", sans-serif; font-size: 10pt; color: #222; margin: 0; }
    h1, h2, h3 { margin: 0 0 0.5rem 0; }
    .header-table { width: 100%; margin-bottom: 1rem; }
    .logo { font-size: 32pt; font-weight: 700; color: #333; }
    .contact-details { font-size: 8pt; line-height: 1.2; color: #555; }
    .invoice-meta { float: right; font-size: 10pt; }

    table.items { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    table.items th, table.items td { padding: 6px 8px; border-bottom: 1px solid #ddd; }
    table.items th { background: #f9f9f9; text-align: left; }
    table.items tr:nth-child(even) { background: #fcfcfc; }
    .right { text-align: right; }

    table.totals { width: 40%; float: right; border-collapse: collapse; margin-top: 1rem; }
    table.totals td { padding: 4px 6px; }
    table.totals tr.total-row td { border-top: 2px solid #333; font-size: 12pt; font-weight: 700; }

    .footer-note { clear: both; font-size: 8pt; color: #555; margin-top: 1rem; }
  </style>
</head>
<body>

  <!-- Header / Seller Info -->
  <table class="header-table">
    <tr>
      <td>
        <div class="logo">{{ company.name }}</div>
        <div class="contact-details">
          {% if company.contact_person %}{% trans "Contact Person:" %} {{ company.contact_person }}<br>{% endif %}
          {% trans "Org-nr:" %} {{ company.org_number }}<br>
          {{ company.address|linebreaksbr }}<br>
          {% trans "Tel:" %} {{ company.phone }} | {% trans "E:" %} {{ company.email }}<br>
          {% if company.IBAN %}{% trans "IBAN:" %} {{ company.IBAN }} {% endif %}
          {% if company.Swish %}{% trans "Swish:" %} {{ company.Swish }} {% endif %}
          {% if company.Bankgiro %}{% trans "Bankgiro:" %} {{ company.Bankgiro }}{% endif %}
        </div>
      </td>
      <td class="invoice-meta">
        <h2>{% trans "INVOICE" %}</h2>
        {% trans "No:" %} {{ invoice.number }}<br>
        {% trans "Date:" %} {{ invoice.issue_date }}<br>
        {% trans "Due:" %} {{ invoice.due_date }}
      </td>
    </tr>
  </table>

  <!-- Bill To -->
  <h5>{% trans "BILL TO:" %}</h5>
  <div class="contact-details">
    <strong>{{ invoice.customer.name }}</strong><br>
    {% if invoice.customer.contact_person %}{% trans "Contact Person:" %} {{ invoice.customer.contact_person }}<br>{% endif %}
    {% if invoice.customer.vat_number %}{% trans "VAT/Org-nr:" %} {{ invoice.customer.vat_number }}<br>{% endif %}
    {{ invoice.customer.address|linebreaksbr }}<br>
    {% if invoice.customer.phone %}{% trans "Tel:" %} {{ invoice.customer.phone }}<br>{% endif %}
    {% if invoice.customer.email %}{% trans "E:" %} {{ invoice.customer.email }}{% endif %}
  </div>

  <!-- Items -->
  <table class="items">
    <thead>
      <tr>
        <th>{% trans "Description" %}</th>
        <th class="right">{% trans "Qty" %}</th>
        <th class="right">{% trans "Unit Price" %}</th>
        <th class="right">{% trans "Line Total" %}</th>
      </tr>
    </thead>
    <tbody>
      {% for line in invoice.lines.all %}
      <tr>
        <td>
          <strong>{{ line.product_name }}</strong>
          {% if line.product_model %}<br><small>{% trans "Model:" %} {{ line.product_model }}</small>{% endif %}
          {% if line.description %}<br><small>{{ line.description }}</small>{% endif %}
        </td>
        <td class="right">{{ line.quantity }}</td>
        <td class="right">{{ line.unit_price }} kr</td>
        <td class="right">{{ line.total_ex_vat }} kr</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  
  {% if invoice.VMB %}
    <p style="margin-top:1rem; font-weight:700;">
        {% trans "VMB-regeln till√§mpas" %}
    </p>
  {% endif %}
  <!-- Totals -->
  <table class="totals">
    <tr><td>{% trans "Subtotal:" %}</td><td class="right">{{ invoice.total_ex_vat }} kr</td></tr>
    <tr>
      <td>{% blocktrans with rate=invoice.vat_rate %}VAT ({{ rate }}%):{% endblocktrans %}</td>
      <td class="right">{{ invoice.vat_total }} kr</td>
    </tr>
    <tr class="total-row"><td>{% trans "TOTAL:" %}</td><td class="right">{{ invoice.total_inc_vat }} kr</td></tr>
  </table>
  <div class="footer-note">
    {% blocktrans with num=invoice.number %}Invoice {{ num }}{% endblocktrans %}
  </div>
  <!-- Footer Note -->
 <footer>
    <div>{% trans "Thank you for your business." %}</div>
    <div class="payment-info">
      {% if company.bankgiro %}{% trans "Bankgiro:" %} {{ company.bankgiro }}{% endif %}
      {% if company.swish %}{% if company.bankgiro %}{% endif %}{% trans "Swish:" %} {{ company.swish }}{% endif %}
      {% if company.iban %}{% if company.bankgiro or company.swish %}{% endif %}{% trans "IBAN:" %} {{ company.iban }}{% endif %}
    </div>
    <div>{{ company.name }} &nbsp;|&nbsp; {{ company.email }} &nbsp;|&nbsp; {{ company.phone }}</div>
  </footer>

</body>
</html>
